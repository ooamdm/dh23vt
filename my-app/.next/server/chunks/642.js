exports.id=642,exports.ids=[642],exports.modules={1320:(e,t,r)=>{Promise.resolve().then(r.bind(r,6924))},3851:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},6924:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var s=r(326),n=r(7626),o=r.n(n),a=r(7577);r(4047),r(2585);var i=r(5779),l=r(76);async function c(e,t){let r=new i.hJ;try{return await (0,i.rh)(e,r),!0}catch(e){return console.error(`Error signing in for ${t}:`,e),!1}}async function u(e,t){try{await Promise.all([(0,i.w7)(e).catch(()=>{}),(0,i.w7)(t).catch(()=>{})])}catch(e){console.warn("Lỗi khi đăng xuất: ",e)}finally{sessionStorage.removeItem("studentActivities"),sessionStorage.removeItem("cachedProject"),sessionStorage.removeItem("currentProject"),console.log("Đ\xe3 đăng xuất khỏi cả hai project v\xe0 xo\xe1 cache.")}}let d=function({user:e,onSignOut:t}){return s.jsx("header",{className:"bg-white shadow-md sticky top-0 z-10",children:s.jsx("div",{className:"container-fluid px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex items-center justify-between h-16 py-3",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[s.jsx("i",{className:"fas fa-chart-line text-2xl text-blue-600 me-3"}),s.jsx("h1",{className:"text-xl font-bold text-gray-900 mb-0",children:"Dashboard"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("div",{id:"user-info",className:"text-right me-3 hidden sm:block",children:[s.jsx("p",{id:"user-name",className:"font-semibold text-gray-800 mb-0",children:e?.displayName||""}),s.jsx("p",{id:"user-email",className:"text-sm text-gray-500 mb-0",children:e?.email||""})]}),s.jsx("img",{id:"user-photo",className:"h-10 w-10 rounded-full me-3",src:e?.photoURL||"https://placehold.co/40x40/aabbcc/ffffff?text=User",alt:"User photo"}),(0,s.jsxs)("button",{id:"logout-btn",className:"btn btn-danger btn-sm",onClick:t,children:[s.jsx("i",{className:"fas fa-sign-out-alt me-2"}),"Đăng xuất"]})]})]})})})},h=function({onSignIn:e}){return(0,s.jsxs)("div",{id:"login-page",className:"min-h-screen flex items-center justify-center bg-gray-50",children:["\xa0 \xa0 ",(0,s.jsxs)("div",{className:"max-w-md w-full bg-white p-8 rounded-xl shadow-lg text-center",children:["\xa0 \xa0 \xa0 \xa0 ",s.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2 animate-fade-in",children:"Dashboard Sinh Vi\xean"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",s.jsx("p",{className:"text-gray-600 mb-6 animate-fade-in-delay-1",children:"Vui l\xf2ng đăng nhập để tiếp tục"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,s.jsxs)("div",{className:"bg-blue-100 border-l-4 border-blue-500 text-blue-700 p-4 mb-6 rounded-md shadow-inner animate-slide-up-fade-in",children:["\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",s.jsx("p",{className:"font-semibold",children:"Hey Gen Z ✌️"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",s.jsx("p",{className:"text-sm",children:"Nếu bạn được chuyển từ Softr sang đ\xe2y để xem điểm th\xec ch\xfac mừng bạn, bạn đ\xe3 đến đ\xfang nơi!! \uD83D\uDD25"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",s.jsx("p",{className:"text-sm mt-2",children:"H\xe3y login bằng t\xe0i khoản Google sinh vi\xean của bạn để bắt đầu nh\xe9!"}),"\xa0 \xa0 \xa0 \xa0 "]}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,s.jsxs)("button",{id:"login-btn",className:"w-full btn btn-lg btn-custom btn-google flex items-center justify-center",onClick:e,children:["\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",s.jsx("i",{className:"fab fa-google me-3"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 Đăng nhập với Google \xa0 \xa0 \xa0 \xa0 "]}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ","\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,s.jsxs)("div",{className:"text-right mt-8",children:["\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",s.jsx("p",{className:"text-lg font-signature",children:"Hồ Quốc Thắng"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",s.jsx("p",{className:"text-sm text-gray-500",children:"Người quản trị"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 "]}),"\xa0 \xa0 "]})]})};function g({children:e}){let[t,r]=(0,a.useState)({}),[n,i]=(0,a.useState)({}),[g,m]=(0,a.useState)({}),[x,b]=(0,a.useState)("projectA"),[p,f]=(0,a.useState)(null),[y,j]=(0,a.useState)({projectA:null,projectB:null}),[w,S]=(0,a.useState)([]),[v,k]=(0,a.useState)({key:"T\xean hoạt động",order:"asc"}),[N,P]=(0,a.useState)(""),[C,L]=(0,a.useState)(!1),[F,A]=(0,a.useState)(!1),[I,$]=(0,a.useState)(!0);(0,a.useCallback)((e,t)=>{e&&x===t?(z(D()),$(!1)):y.projectA||y.projectB||!F||$(!0)},[x,y,F]);let D=(0,a.useCallback)(()=>{let e=y[x];return e?e.email:null},[x,y]),z=(0,a.useCallback)(async e=>{let t=sessionStorage.getItem("studentActivities"),r=sessionStorage.getItem("cachedProject");if(t&&x===r)try{S(JSON.parse(t));return}catch(e){console.warn("Lỗi ph\xe2n t\xedch c\xfa ph\xe1p cache, đang lấy dữ liệu mới",e)}await K(e)},[x]),K=(0,a.useCallback)(async e=>{if(!e||!p){console.error("Lỗi: Kh\xf4ng c\xf3 email hoặc cơ sở dữ liệu để tải dữ liệu."),L(!1);return}if(console.log(`Đang lấy dữ liệu mới từ Firestore Project: ${x}...`),L(!0),!n[x].currentUser&&(console.warn(`Người d\xf9ng chưa đăng nhập v\xe0o Project ${x}. Đang cố gắng đăng nhập.`),!await c(n[x],x))){console.error(`Kh\xf4ng thể lấy dữ liệu v\xec đăng nhập v\xe0o Project ${x} thất bại.`),L(!1);return}let t=function(e,t,r,s,n){if(!e||!t)return n(Error("Database instance or email is missing.")),()=>{};let o=(0,l.hJ)(e,"studentActivities"),a=(0,l.IO)(o,(0,l.ar)("Email","==",t));return(0,l.cf)(a,e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),s(t)},e=>{(function(e){let t=String(e?.code||"").toLowerCase(),r=String(e?.message||"").toLowerCase();t.includes("resource-exhausted")||r.includes("quota")||r.includes("exhausted")?console.error("Lỗi Firestore: Kho dữ liệu hiện tại đang qu\xe1 tải (hết quota).",e):t.includes("permission-denied")||r.includes("permission-denied")?console.error("Lỗi Firestore: Kh\xf4ng c\xf3 quyền truy cập dữ liệu cho kho n\xe0y. Vui l\xf2ng kiểm tra Rules hoặc đăng nhập lại.",e):console.error("Lỗi Firestore: Kh\xf4ng thể tải dữ liệu từ server. Vui l\xf2ng kiểm tra kết nối.",e)})(e),n(e)})}(p,e,0,e=>{S(e),sessionStorage.setItem("studentActivities",JSON.stringify(e)),sessionStorage.setItem("cachedProject",x),console.log("Dữ liệu đ\xe3 được l\xe0m mới v\xe0 lưu v\xe0o cache."),L(!1)},e=>{console.error("Lỗi khi lắng nghe dữ liệu từ Firestore: ",e),L(!1)});return()=>t()},[x,p,n]),T=(0,a.useCallback)(async e=>y[e]?(console.log(`Người d\xf9ng đ\xe3 đăng nhập v\xe0o Project ${e}.`),!0):(console.log(`Người d\xf9ng chưa đăng nhập v\xe0o Project ${e}. Đang cố gắng đăng nhập tự động...`),await c(n[e],e)),[y,n]);(0,a.useCallback)(async e=>{if(x===e){console.log(`Đ\xe3 ở Project ${e}. Kh\xf4ng cần chuyển đổi.`);return}if(console.log(`Đang y\xeau cầu chuyển đổi sang Project: ${e}`),!await T(e)){console.error(`Kh\xf4ng thể chuyển sang Project ${e} v\xec đăng nhập thất bại.`);return}b(e),sessionStorage.setItem("currentProject",e),console.log(`Đ\xe3 chuyển sang Project: ${e}`)},[x,T,n]),(0,a.useCallback)(e=>{switch(e){case"Ph\xea duyệt":case"Sent":return"bg-green-100 text-green-700";case"Đang xử l\xfd":case"Processing":return"bg-yellow-100 text-yellow-700";case"Từ chối":case"Cancelled":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},[]);let q=(0,a.useCallback)(e=>{let t=["c\xe1n bộ","Ban chấp h\xe0nh","gương mẫu","ho\xe0n th\xe0nh tốt","Đo\xe0n","Hội"],r=["Nghi\xean cứu khoa học","Dự \xe1n khoa học"],s=["CLB học thuật","Hội thảo học thuật"],n=0;e.some(e=>t.some(t=>String(e["T\xean hoạt động"]||"").toLowerCase().includes(t.toLowerCase())))&&n++,e.some(e=>r.some(t=>String(e["T\xean hoạt động"]||"").toLowerCase().includes(t.toLowerCase()))&&"ph\xea duyệt"===String(e.Status||"").toLowerCase())&&n++,e.some(e=>s.some(t=>String(e["T\xean hoạt động"]||"").toLowerCase().includes(t.toLowerCase()))&&"ph\xea duyệt"===String(e.Status||"").toLowerCase())&&n++;let o="";return o=0===n?"Nh\xf3m 90":1===n?"Nh\xf3m 95":"Nh\xf3m 100",{points:n,group:o}},[]),B=(0,a.useCallback)(e=>[...e].sort((e,t)=>{let r=e[v.key]??"",s=t[v.key]??"";if("Điểm cộng"===v.key){let e=Number.isFinite(parseFloat(String(r).replace(",",".")))?parseFloat(String(r).replace(",",".")):-1/0,t=Number.isFinite(parseFloat(String(s).replace(",",".")))?parseFloat(String(s).replace(",",".")):-1/0;return"asc"===v.order?e-t:t-e}let n=String(r).toLowerCase(),o=String(s).toLowerCase();return n<o?"asc"===v.order?-1:1:n>o?"asc"===v.order?1:-1:0}),[v]);(0,a.useMemo)(()=>B(w.filter(e=>Object.values(e||{}).some(e=>String(e||"").toLowerCase().includes(N.toLowerCase())))),[w,N,B]),(0,a.useMemo)(()=>{let e=w.length,t=w.filter(e=>"Ph\xea duyệt"===e.Status).length,r=w.filter(e=>"Đang chờ"===e.Status).length,s=w.filter(e=>"Kh\xf4ng ph\xea duyệt"===e.Status).length,n=w.reduce((e,t)=>{let r=parseFloat(String(t["Điểm cộng"]).replace(",","."));return e+(Number.isFinite(r)?r:0)},0),o=w.filter(e=>"Ph\xea duyệt"===e.Status),a=o.reduce((e,t)=>{let r=parseFloat(String(t["Điểm cộng"]).replace(",","."));return e+(Number.isFinite(r)?r:0)},0),i=w.length>0?q(w):{group:"N/A"};return console.log("Mảng hoạt động đ\xe3 được ph\xea duyệt:",o),console.log("Tổng điểm đ\xe3 ph\xea duyệt:",a),{totalActivities:e,sentCount:t,processingCount:r,cancelledCount:s,totalPoints:n.toFixed(2),totalApprovedPoints:a.toFixed(2),classificationGroup:i.group}},[w,q]);let E=y[x];return s.jsx("html",{lang:"vi",children:s.jsx("body",{children:(0,s.jsxs)("div",{className:"jsx-86dbf86fb5d4e436 antialiased text-gray-800",children:[s.jsx(o(),{id:"86dbf86fb5d4e436",children:'body{font-family:"Inter",sans-serif;background-color:#f3f4f6}::-webkit-scrollbar{width:8px}::-webkit-scrollbar-track{background:#f1f1f1}::-webkit-scrollbar-thumb{background:#888;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px}::-webkit-scrollbar-thumb:hover{background:#555}.sort-icon{opacity:.5;-webkit-transition:opacity.2s;-moz-transition:opacity.2s;-o-transition:opacity.2s;transition:opacity.2s;margin-left:.5rem}.sort-icon:hover{opacity:1}.th-sortable{cursor:pointer}.card-custom{-webkit-transition:-webkit-transform.2s ease-in-out;-moz-transition:-moz-transform.2s ease-in-out;-o-transition:-o-transform.2s ease-in-out;transition:-webkit-transform.2s ease-in-out;transition:-moz-transform.2s ease-in-out;transition:-o-transform.2s ease-in-out;transition:transform.2s ease-in-out}.card-custom:hover{-webkit-transform:translatey(-5px);-moz-transform:translatey(-5px);-ms-transform:translatey(-5px);-o-transform:translatey(-5px);transform:translatey(-5px)}.btn-custom{padding:10px 20px;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;font-weight:600}.btn-google{background-color:#4285F4;color:white}.btn-google:hover{background-color:#357AE8}@media(max-width:575.98px){.search-refresh-group .input-group{width:100%;margin-bottom:1rem}.search-refresh-group .btn{width:100%}.project-selector .btn{margin-bottom:.5rem}}'}),I?s.jsx(h,{onSignIn:()=>c(n[x],x)}):(0,s.jsxs)("div",{id:"dashboard-page",className:"jsx-86dbf86fb5d4e436",children:[s.jsx(d,{user:E,onSignOut:()=>u(n.projectA,n.projectB)}),s.jsx("main",{className:"jsx-86dbf86fb5d4e436 container mx-auto py-4 px-4",children:e})]})]})})})}},7139:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(8570).createProxy)(String.raw`/workspaces/dh23vt/my-app/app/layout.jsx#default`)},4047:()=>{}};