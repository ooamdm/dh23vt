exports.id=855,exports.ids=[855],exports.modules={103:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,6133,23)),Promise.resolve().then(c.t.bind(c,6444,23)),Promise.resolve().then(c.t.bind(c,6042,23)),Promise.resolve().then(c.t.bind(c,9477,23)),Promise.resolve().then(c.t.bind(c,9345,23)),Promise.resolve().then(c.t.bind(c,2089,23)),Promise.resolve().then(c.t.bind(c,6577,23)),Promise.resolve().then(c.t.bind(c,1307,23)),Promise.resolve().then(c.t.bind(c,4817,23))},4015:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,5227,23)),Promise.resolve().then(c.t.bind(c,6346,23)),Promise.resolve().then(c.t.bind(c,7924,23)),Promise.resolve().then(c.t.bind(c,99,23)),Promise.resolve().then(c.t.bind(c,8243,23)),Promise.resolve().then(c.t.bind(c,8827,23)),Promise.resolve().then(c.t.bind(c,2763,23)),Promise.resolve().then(c.t.bind(c,7173,23)),Promise.resolve().then(c.bind(c,5587))},5843:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>n});var d=c(687),e=c(6180),f=c.n(e),g=c(3210);c(6080),c(7989);var h=c(1448),i=c(5535);async function j(a,b){let c=new h.HF;try{return await (0,h.df)(a,c),!0}catch(a){return console.error(`Error signing in for ${b}:`,a),!1}}async function k(a,b){try{await Promise.all([(0,h.CI)(a).catch(()=>{}),(0,h.CI)(b).catch(()=>{})])}catch(a){console.warn("Lỗi khi đăng xuất: ",a)}finally{sessionStorage.removeItem("studentActivities"),sessionStorage.removeItem("cachedProject"),sessionStorage.removeItem("currentProject"),console.log("Đ\xe3 đăng xuất khỏi cả hai project v\xe0 xo\xe1 cache.")}}let l=function({user:a,onSignOut:b}){return(0,d.jsx)("header",{className:"bg-white shadow-md sticky top-0 z-10",children:(0,d.jsx)("div",{className:"container-fluid px-4 sm:px-6 lg:px-8",children:(0,d.jsxs)("div",{className:"flex items-center justify-between h-16 py-3",children:[(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("i",{className:"fas fa-chart-line text-2xl text-blue-600 me-3"}),(0,d.jsx)("h1",{className:"text-xl font-bold text-gray-900 mb-0",children:"Dashboard"})]}),(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsxs)("div",{id:"user-info",className:"text-right me-3 hidden sm:block",children:[(0,d.jsx)("p",{id:"user-name",className:"font-semibold text-gray-800 mb-0",children:a?.displayName||""}),(0,d.jsx)("p",{id:"user-email",className:"text-sm text-gray-500 mb-0",children:a?.email||""})]}),(0,d.jsx)("img",{id:"user-photo",className:"h-10 w-10 rounded-full me-3",src:a?.photoURL||"https://placehold.co/40x40/aabbcc/ffffff?text=User",alt:"User photo"}),(0,d.jsxs)("button",{id:"logout-btn",className:"btn btn-danger btn-sm",onClick:b,children:[(0,d.jsx)("i",{className:"fas fa-sign-out-alt me-2"}),"Đăng xuất"]})]})]})})})},m=function({onSignIn:a}){return(0,d.jsxs)("div",{id:"login-page",className:"min-h-screen flex items-center justify-center bg-gray-50",children:["\xa0 \xa0 ",(0,d.jsxs)("div",{className:"max-w-md w-full bg-white p-8 rounded-xl shadow-lg text-center",children:["\xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2 animate-fade-in",children:"Dashboard Sinh Vi\xean"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("p",{className:"text-gray-600 mb-6 animate-fade-in-delay-1",children:"Vui l\xf2ng đăng nhập để tiếp tục"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsxs)("div",{className:"bg-blue-100 border-l-4 border-blue-500 text-blue-700 p-4 mb-6 rounded-md shadow-inner animate-slide-up-fade-in",children:["\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("p",{className:"font-semibold",children:"Hey Gen Z ✌️"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("p",{className:"text-sm",children:"Nếu bạn được chuyển từ Softr sang đ\xe2y để xem điểm th\xec ch\xfac mừng bạn, bạn đ\xe3 đến đ\xfang nơi!! \uD83D\uDD25"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("p",{className:"text-sm mt-2",children:"H\xe3y login bằng t\xe0i khoản Google sinh vi\xean của bạn để bắt đầu nh\xe9!"}),"\xa0 \xa0 \xa0 \xa0 "]}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsxs)("button",{id:"login-btn",className:"w-full btn btn-lg btn-custom btn-google flex items-center justify-center",onClick:a,children:["\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("i",{className:"fab fa-google me-3"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 Đăng nhập với Google \xa0 \xa0 \xa0 \xa0 "]}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ","\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsxs)("div",{className:"text-right mt-8",children:["\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("p",{className:"text-lg font-signature",children:"Hồ Quốc Thắng"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 ",(0,d.jsx)("p",{className:"text-sm text-gray-500",children:"Người quản trị"}),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 "]}),"\xa0 \xa0 "]})]})};function n({children:a}){let[b,c]=(0,g.useState)({}),[e,h]=(0,g.useState)({}),[n,o]=(0,g.useState)({}),[p,q]=(0,g.useState)("projectA"),[r,s]=(0,g.useState)(null),[t,u]=(0,g.useState)({projectA:null,projectB:null}),[v,w]=(0,g.useState)([]),[x,y]=(0,g.useState)({key:"T\xean hoạt động",order:"asc"}),[z,A]=(0,g.useState)(""),[B,C]=(0,g.useState)(!1),[D,E]=(0,g.useState)(!1),[F,G]=(0,g.useState)(!0);(0,g.useCallback)((a,b)=>{a&&p===b?(I(H()),G(!1)):t.projectA||t.projectB||!D||G(!0)},[p,t,D]);let H=(0,g.useCallback)(()=>{let a=t[p];return a?a.email:null},[p,t]),I=(0,g.useCallback)(async a=>{let b=sessionStorage.getItem("studentActivities"),c=sessionStorage.getItem("cachedProject");if(b&&p===c)try{w(JSON.parse(b));return}catch(a){console.warn("Lỗi ph\xe2n t\xedch c\xfa ph\xe1p cache, đang lấy dữ liệu mới",a)}await J(a)},[p]),J=(0,g.useCallback)(async a=>{if(!a||!r){console.error("Lỗi: Kh\xf4ng c\xf3 email hoặc cơ sở dữ liệu để tải dữ liệu."),C(!1);return}if(console.log(`Đang lấy dữ liệu mới từ Firestore Project: ${p}...`),C(!0),!e[p].currentUser&&(console.warn(`Người d\xf9ng chưa đăng nhập v\xe0o Project ${p}. Đang cố gắng đăng nhập.`),!await j(e[p],p))){console.error(`Kh\xf4ng thể lấy dữ liệu v\xec đăng nhập v\xe0o Project ${p} thất bại.`),C(!1);return}let b=function(a,b,c,d,e){if(!a||!b)return e(Error("Database instance or email is missing.")),()=>{};let f=(0,i.rJ)(a,"studentActivities"),g=(0,i.P)(f,(0,i._M)("Email","==",b));return(0,i.aQ)(g,a=>{let b=[];a.forEach(a=>{b.push({id:a.id,...a.data()})}),d(b)},a=>{(function(a){let b=String(a?.code||"").toLowerCase(),c=String(a?.message||"").toLowerCase();b.includes("resource-exhausted")||c.includes("quota")||c.includes("exhausted")?console.error("Lỗi Firestore: Kho dữ liệu hiện tại đang qu\xe1 tải (hết quota).",a):b.includes("permission-denied")||c.includes("permission-denied")?console.error("Lỗi Firestore: Kh\xf4ng c\xf3 quyền truy cập dữ liệu cho kho n\xe0y. Vui l\xf2ng kiểm tra Rules hoặc đăng nhập lại.",a):console.error("Lỗi Firestore: Kh\xf4ng thể tải dữ liệu từ server. Vui l\xf2ng kiểm tra kết nối.",a)})(a),e(a)})}(r,a,0,a=>{w(a),sessionStorage.setItem("studentActivities",JSON.stringify(a)),sessionStorage.setItem("cachedProject",p),console.log("Dữ liệu đ\xe3 được l\xe0m mới v\xe0 lưu v\xe0o cache."),C(!1)},a=>{console.error("Lỗi khi lắng nghe dữ liệu từ Firestore: ",a),C(!1)});return()=>b()},[p,r,e]),K=(0,g.useCallback)(async a=>t[a]?(console.log(`Người d\xf9ng đ\xe3 đăng nhập v\xe0o Project ${a}.`),!0):(console.log(`Người d\xf9ng chưa đăng nhập v\xe0o Project ${a}. Đang cố gắng đăng nhập tự động...`),await j(e[a],a)),[t,e]);(0,g.useCallback)(async a=>p===a?void console.log(`Đ\xe3 ở Project ${a}. Kh\xf4ng cần chuyển đổi.`):(console.log(`Đang y\xeau cầu chuyển đổi sang Project: ${a}`),await K(a))?void(q(a),sessionStorage.setItem("currentProject",a),console.log(`Đ\xe3 chuyển sang Project: ${a}`)):void console.error(`Kh\xf4ng thể chuyển sang Project ${a} v\xec đăng nhập thất bại.`),[p,K,e]),(0,g.useCallback)(a=>{switch(a){case"Ph\xea duyệt":case"Sent":return"bg-green-100 text-green-700";case"Đang xử l\xfd":case"Processing":return"bg-yellow-100 text-yellow-700";case"Từ chối":case"Cancelled":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},[]);let L=(0,g.useCallback)(a=>{let b=["c\xe1n bộ","Ban chấp h\xe0nh","gương mẫu","ho\xe0n th\xe0nh tốt","Đo\xe0n","Hội"],c=["Nghi\xean cứu khoa học","Dự \xe1n khoa học"],d=["CLB học thuật","Hội thảo học thuật"],e=0;a.some(a=>b.some(b=>String(a["T\xean hoạt động"]||"").toLowerCase().includes(b.toLowerCase())))&&e++,a.some(a=>c.some(b=>String(a["T\xean hoạt động"]||"").toLowerCase().includes(b.toLowerCase()))&&"ph\xea duyệt"===String(a.Status||"").toLowerCase())&&e++,a.some(a=>d.some(b=>String(a["T\xean hoạt động"]||"").toLowerCase().includes(b.toLowerCase()))&&"ph\xea duyệt"===String(a.Status||"").toLowerCase())&&e++;let f="";return f=0===e?"Nh\xf3m 90":1===e?"Nh\xf3m 95":"Nh\xf3m 100",{points:e,group:f}},[]),M=(0,g.useCallback)(a=>[...a].sort((a,b)=>{let c=a[x.key]??"",d=b[x.key]??"";if("Điểm cộng"===x.key){let a=Number.isFinite(parseFloat(String(c).replace(",",".")))?parseFloat(String(c).replace(",",".")):-1/0,b=Number.isFinite(parseFloat(String(d).replace(",",".")))?parseFloat(String(d).replace(",",".")):-1/0;return"asc"===x.order?a-b:b-a}let e=String(c).toLowerCase(),f=String(d).toLowerCase();return e<f?"asc"===x.order?-1:1:e>f?"asc"===x.order?1:-1:0}),[x]);(0,g.useMemo)(()=>M(v.filter(a=>Object.values(a||{}).some(a=>String(a||"").toLowerCase().includes(z.toLowerCase())))),[v,z,M]),(0,g.useMemo)(()=>{let a=v.length,b=v.filter(a=>"Ph\xea duyệt"===a.Status).length,c=v.filter(a=>"Đang chờ"===a.Status).length,d=v.filter(a=>"Kh\xf4ng ph\xea duyệt"===a.Status).length,e=v.reduce((a,b)=>{let c=parseFloat(String(b["Điểm cộng"]).replace(",","."));return a+(Number.isFinite(c)?c:0)},0),f=v.filter(a=>"Ph\xea duyệt"===a.Status),g=f.reduce((a,b)=>{let c=parseFloat(String(b["Điểm cộng"]).replace(",","."));return a+(Number.isFinite(c)?c:0)},0),h=v.length>0?L(v):{group:"N/A"};return console.log("Mảng hoạt động đ\xe3 được ph\xea duyệt:",f),console.log("Tổng điểm đ\xe3 ph\xea duyệt:",g),{totalActivities:a,sentCount:b,processingCount:c,cancelledCount:d,totalPoints:e.toFixed(2),totalApprovedPoints:g.toFixed(2),classificationGroup:h.group}},[v,L]);let N=t[p];return(0,d.jsx)("html",{lang:"vi",children:(0,d.jsx)("body",{children:(0,d.jsxs)("div",{className:"jsx-86dbf86fb5d4e436 antialiased text-gray-800",children:[(0,d.jsx)(f(),{id:"86dbf86fb5d4e436",children:'body{font-family:"Inter",sans-serif;background-color:#f3f4f6}::-webkit-scrollbar{width:8px}::-webkit-scrollbar-track{background:#f1f1f1}::-webkit-scrollbar-thumb{background:#888;border-radius:10px}::-webkit-scrollbar-thumb:hover{background:#555}.sort-icon{opacity:.5;transition:opacity.2s;margin-left:.5rem}.sort-icon:hover{opacity:1}.th-sortable{cursor:pointer}.card-custom{transition:transform.2s ease-in-out}.card-custom:hover{transform:translatey(-5px)}.btn-custom{padding:10px 20px;border-radius:8px;font-weight:600}.btn-google{background-color:#4285F4;color:white}.btn-google:hover{background-color:#357AE8}@media(max-width:575.98px){.search-refresh-group .input-group{width:100%;margin-bottom:1rem}.search-refresh-group .btn{width:100%}.project-selector .btn{margin-bottom:.5rem}}'}),F?(0,d.jsx)(m,{onSignIn:()=>j(e[p],p)}):(0,d.jsxs)("div",{id:"dashboard-page",className:"jsx-86dbf86fb5d4e436",children:[(0,d.jsx)(l,{user:N,onSignOut:()=>k(e.projectA,e.projectB)}),(0,d.jsx)("main",{className:"jsx-86dbf86fb5d4e436 container mx-auto py-4 px-4",children:a})]})]})})})}},6080:()=>{},7262:(a,b,c)=>{Promise.resolve().then(c.bind(c,7824))},7430:(a,b,c)=>{Promise.resolve().then(c.bind(c,5843))},7824:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>d});let d=(0,c(1369).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/workspaces/dh23vt/my-app/app/layout.jsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/workspaces/dh23vt/my-app/app/layout.jsx","default")}};